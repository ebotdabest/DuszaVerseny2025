<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="DuszaVerseny2025.GamePage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="DuszaVerseny2025"
             BackgroundColor="White">
    <Grid RowDefinitions="Auto, 150, *, 150, Auto"
          ColumnDefinitions="*, 250">
        <Label Grid.Row="0"
               Grid.Column="0"
               Grid.ColumnSpan="2"
               Text="{Binding TopLabelText}"
               FontSize="18"
               FontFamily="RetroByte"
               FontAttributes="Bold"
               HorizontalOptions="Center"
               Margin="0,20,0,10"/>
        
        <Border Grid.Row="1"
                Grid.Column="0"
                BackgroundColor="LightGray"
                Stroke="Black"
                StrokeThickness="2"
                StrokeShape="RoundRectangle 50"
                Margin="10">
            <VerticalStackLayout Spacing="10"
                                 HorizontalOptions="Center"
                                 VerticalOptions="Center">

                <Border x:Name="BossFrame"
                        BackgroundColor="#2c3e50"
                        Stroke="Red"
                        StrokeThickness="3"
                        Padding="10"
                        Margin="2"
                        HorizontalOptions="Center"
                        IsVisible="{Binding HasBoss}">
                    <Grid>
                        <BoxView Color="{Binding Boss.Template.ElementColor}" CornerRadius="8"/>
                        <Label Text="{Binding Boss.Template.Name}"
                               FontSize="18"
                               TextColor="White"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                    </Grid>
                </Border>

                <CollectionView ItemsSource="{Binding EnemyRegularCards}"
                                HeightRequest="100"
                                ItemsLayout="HorizontalList"
                                HorizontalOptions="Center">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border BackgroundColor="#2c3e50"
                                    Stroke="Orange"
                                    StrokeThickness="2"
                                    Padding="6"
                                    Margin="2">
                                <Grid>
                                    <BoxView Color="{Binding Template.ElementColor}" CornerRadius="8"/>
                                    <Label Text="{Binding Template.Name}"
                                           FontSize="14"
                                           TextColor="White"
                                           FontAttributes="Bold"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Border>

        <Border Grid.Row="2"
                Grid.Column="0"
                BackgroundColor="DarkGray"
                Stroke="Black"
                StrokeThickness="2"
                StrokeShape="RoundRectangle 20"
                Margin="10">
            <Grid RowDefinitions="*, Auto, *"
                  ColumnDefinitions="*">

                <Border Grid.Row="0"
                        HorizontalOptions="Center"
                        VerticalOptions="End"
                        BackgroundColor="#2c3e50"
                        Stroke="Red"
                        StrokeThickness="2"
                        Padding="8"
                        Margin="0,0,0,10"
                        IsVisible="{Binding CurrentEnemyFighter, Converter={StaticResource NotNullConverter}}">
                    <Grid>
                        <BoxView Color="{Binding CurrentEnemyFighter.Template.ElementColor}" CornerRadius="8"/>
                        <Label Text="{Binding CurrentEnemyFighter.Template.Name}"
                               FontSize="16"
                               TextColor="White"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                    </Grid>
                </Border>

                <Border Grid.Row="2"
                        HorizontalOptions="Center"
                        VerticalOptions="Start"
                        BackgroundColor="#2c3e50"
                        Stroke="Blue"
                        StrokeThickness="2"
                        Padding="8"
                        Margin="0,10,0,0"
                        IsVisible="{Binding CurrentPlayerFighter, Converter={StaticResource NotNullConverter}}">
                    <Grid>
                        <BoxView Color="{Binding CurrentPlayerFighter.Template.ElementColor}" CornerRadius="8"/>
                        <Label Text="{Binding CurrentPlayerFighter.Template.Name}"
                               FontSize="16"
                               TextColor="White"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <Border Grid.Row="3"
                Grid.Column="0"
                BackgroundColor="LightGray"
                Stroke="Black"
                StrokeThickness="2"
                StrokeShape="RoundRectangle 50"
                Margin="10">
            <VerticalStackLayout HorizontalOptions="Center"
                                 VerticalOptions="Center">
                <Label Text="Your Team:"
                       FontSize="18"
                       TextColor="Gold"
                       HorizontalOptions="Center" />
                <CollectionView ItemsSource="{Binding SelectedCards}"
                                HeightRequest="100"
                                ItemsLayout="HorizontalList"
                                HorizontalOptions="Center">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border BackgroundColor="#2c3e50"
                                    Stroke="Orange"
                                    StrokeThickness="2"
                                    Padding="6"
                                    Margin="2">
                                <Grid>
                                    <BoxView Color="{Binding Template.ElementColor}" CornerRadius="8"/>
                                    <Label Text="{Binding Template.Name}"
                                           FontSize="14"
                                           TextColor="White"
                                           FontAttributes="Bold"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Border>

        <Border Grid.Row="1"
                Grid.Column="1"
                Grid.RowSpan="3"
                BackgroundColor="White"
                Stroke="Black"
                StrokeThickness="1"
                Margin="10">
            <VerticalStackLayout Margin="10">
                <Label Text="Tortenesei â–¼"
                       FontSize="16"
                       FontFamily="RetroByte"
                       FontAttributes="Bold"/>
                <ScrollView>
                    <CollectionView ItemsSource="{Binding HistoryItems}"
                                    HeightRequest="500">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Border BackgroundColor="WhiteSmoke"
                                        Padding="5"
                                        Margin="0,2">
                                    <Label Text="{Binding HistoryText}"
                                           FontSize="12"
                                           FontFamily="RetroByte"
                                           LineBreakMode="WordWrap"/>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </ScrollView>
            </VerticalStackLayout>
        </Border>

        <Label Grid.Row="4"
               Grid.Column="0"
               Grid.ColumnSpan="2"
               Text="{Binding RoundText}"
               FontSize="20"
               FontAttributes="Bold"
               HorizontalOptions="Center"
               FontFamily="RetroByte"
               Margin="0,10,0,20"/>
    </Grid>
</ContentPage>