<!DOCTYPE html>
<html lang="hu">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DAMAREEN</title>
    <link rel="icon" href="data:," />
    <link rel="stylesheet" href="styles/app.css" />
    <script src="scripts/HybridWebView.js"></script>
    <script src="scripts/ux-enhancements.js"></script>
  </head>

  <body>
    <div class="container">
      <header class="game-header">
        <button
          class="btnBackToMenu"
          id="headerBackButton"
          onclick="showMainMenu(true)"
          title="Men√º"
          style="display: none"
        >
          ‚ò∞
        </button>
        <h1 class="game-title">DAMAREEN</h1>
        <div class="game-subtitle">‚ôî</div>
      </header>

      <div class="main-content" id="mainGameContent" style="display: none">
        <div class="left-panel">
          <div class="section">
            <!-- Page Switch Buttons -->
            <div class="page-switch-container">
              <button
                class="page-switch-btn active"
                onclick="switchCardGrid('cards')"
              >
                Gy≈±jtem√©ny
              </button>
              <button
                class="page-switch-btn"
                onclick="switchCardGrid('powers')"
              >
                K√©pess√©gek
              </button>
            </div>

            <!-- Card Collection Grid -->
            <div id="cardGridContainer" class="card-grid-container active">
              <div id="cardCollection" class="card-grid"></div>
            </div>

            <!-- Power Card Collection Grid -->
            <div id="powerCardGridContainer" class="card-grid-container">
              <div id="powercardCollection" class="card-grid"></div>
            </div>
          </div>

          <div class="selection-counter" id="selectionCounter">
            Kiv√°lasztva: 0 / 0
          </div>

          <div class="section deck-section">
            <h2 class="section-title">Pakli</h2>
            <div id="selectedDeck" class="deck-container"></div>
          </div>
        </div>

        <div class="right-panel">
          <h2 class="section-title" id="dungeonPanelTitle">Kazamat√°k</h2>

          <!-- Dungeon Lists Container with Slide Animation -->
          <div class="dungeon-lists-container">
            <!-- Dungeons List -->
            <div class="dungeon-list-wrapper active" id="dungeonsWrapper">
              <div id="dungeonList" class="dungeon-list"></div>
            </div>

            <!-- Dungeon Paths List -->
            <div class="dungeon-list-wrapper slide-right" id="pathsWrapper">
              <div id="dungeonPathsList" class="dungeon-list">
                <div style="color: #666; text-align: center; padding: 20px">
                  Katakomb√°k (Hamarosan...)
                </div>
              </div>
            </div>
          </div>

          <!-- Floating Toggle Button -->
          <button
            class="dungeon-view-toggle"
            id="dungeonViewToggle"
            onclick="toggleDungeonView()"
          >
            Katakomb√°k
          </button>
        </div>
      </div>
    </div>

    <div id="main-menu">
      <button id="btnNewGame" onclick="newGame()">√öj j√°t√©k</button>
      <button id="btnLoadGame" onclick="loadGame()">Bet√∂lt√©s</button>
      <button id="btnEditor" onclick="editor()">Vil√°gszerkeszt≈ë</button>
      <button id="btnExit" onclick="exit()">Kil√©p√©s</button>
    </div>

    <div id="alertModal" class="modal">
      <div class="modal-content">
        <p id="alertMessage"></p>
        <button onclick="closeAlert()" class="modal-btn">OK</button>
      </div>
    </div>

    <div id="loading-screen" class="loading-screen">
      <div class="loading-content">
        <div class="rotating-cross">‚úü</div>
        <div class="loading-bar-container">
          <div class="loading-bar"></div>
        </div>
        <div class="loading-text">BET√ñLT√âS...</div>
      </div>
      <div class="stars"></div>
    </div>

    <div id="new-game-page" class="fake-page">
      <button class="btnBackToMenu absolute" onclick="showMainMenu()">‚óÑ</button>
      <h2 class="page-title">√öj J√°t√©k Ind√≠t√°sa</h2>
      <div class="fake-page-content">
        <div class="form-group">
          <label>Ment√©s Neve:</label>
          <input type="text" id="saveName" placeholder="Add meg a nevet..." />
        </div>
        <div class="form-group">
          <label>Vil√°g Sablon:</label>
          <select id="worldTemplate">
            <option value="">V√°lassz sablont...</option>
          </select>
        </div>
        <div class="form-group">
          <label>Neh√©zs√©g: <span id="difficultyValue">5</span></label>
          <input
            type="range"
            id="difficulty"
            min="0"
            max="10"
            value="5"
            class="custom-slider"
            oninput="document.getElementById('difficultyValue').textContent = this.value"
          />
        </div>
        <div class="button-row">
          <button
            class="action-btn"
            id="makeTheGameButtonHasToBeUniqueAAAAA"
            onclick="startNewGame()"
          >
            Ind√≠t√°s
          </button>
        </div>
      </div>
    </div>

    <div id="load-game-page" class="fake-page">
      <h2 class="page-title">J√°t√©k Bet√∂lt√©se</h2>
      <div id="saveList" class="save-list-container"></div>
      <button class="btnBackToMenu absolute" onclick="showMainMenu()">‚óÑ</button>
    </div>

    <div id="editor-page" class="fake-page">
      <div id="contextClose" onclick="closeContextMenu()"></div>
      <button class="btnBackToMenu absolute" onclick="showMainMenu()">‚óÑ</button>
      <h2 class="page-title">‚öôÔ∏è Vil√°gszerkeszt≈ë</h2>

      <div class="editor-layout">
        <div class="editor-sidebar">
          <div class="section-header">VIL√ÅG KEZEL√âS</div>
          <button class="editor-tab" onclick="switchEditorTab('settings')">
            üìã √Åltal√°nos
          </button>

          <div class="spacer"></div>

          <div class="section-header">TARTALOM L√âTREHOZ√ÅSA</div>
          <button class="editor-tab" onclick="switchEditorTab('cards')">
            üÉè K√°rty√°k
          </button>
          <button class="editor-tab" onclick="switchEditorTab('abilities')">
            ‚ö° K√©pess√©gek
          </button>
          <button class="editor-tab" onclick="switchEditorTab('sets')">
            üì¶ Szettek
          </button>
          <button class="editor-tab" onclick="switchEditorTab('dungeons')">
            üè∞ Kazamat√°k
          </button>

          <div class="spacer"></div>

          <div class="section-header">J√ÅT√âK BE√ÅLL√çT√ÅSOK</div>
          <button class="editor-tab" onclick="switchEditorTab('plydeck')">
            üé¥ Kezd≈ëpakli
          </button>
          <button class="editor-tab" onclick="switchEditorTab('paths')">
            üó∫Ô∏è Katakomb√°k
          </button>

          <div class="flex-spacer"></div>

          <div class="bottom-divider"></div>
          <button class="editor-tab" id="btnSaveWorld" onclick="saveWorld()">
            üíæ Ment√©s
          </button>
          <button class="editor-tab" id="btnLoadWorld" onclick="loadWorld()">
            üìÇ Bet√∂lt√©s
          </button>
        </div>

        <div class="editor-content">
          <div id="editor-settings" class="editor-section active">
            <div class="editor-breadcrumb">
              <span>Vil√°gszerkeszt≈ë</span> /
              <span class="current">√Åltal√°nos Be√°ll√≠t√°sok</span>
            </div>

            <h3>‚öôÔ∏è Vil√°g Be√°ll√≠t√°sok</h3>
            <h5>A vil√°g sablon alapvet≈ë adatai √©s tartalmai</h5>

            <div class="form-group">
              <label>Vil√°g Sablon Neve:</label>
              <input
                type="text"
                id="worldName"
                placeholder="Add meg a vil√°g nev√©t..."
              />
            </div>

            <div class="spacer-30"></div>

            <h3>üìö Tartalmi √Åttekint√©s</h3>
            <h5>A vil√°gban jelenleg el√©rhet≈ë elemek</h5>

            <div class="mb-30">
              <div class="flex-header">
                <h4 class="subheader">K√°rty√°k</h4>
                <button
                  class="action-btn small small-btn"
                  onclick="switchEditorTab('cards')"
                >
                  + √öj K√°rtya
                </button>
              </div>
              <div id="allCardsList" class="scrollable-list small"></div>
            </div>

            <div class="mb-30">
              <div class="flex-header">
                <h4 class="subheader">Vez√©rek (Boss-ok)</h4>
                <button
                  class="action-btn small small-btn"
                  onclick="switchEditorTab('cards')"
                >
                  + √öj Vez√©r
                </button>
              </div>
              <div id="allBosses" class="scrollable-list small"></div>
            </div>

            <div class="mb-30">
              <div class="flex-header">
                <h4 class="subheader">Szettek</h4>
                <button
                  class="action-btn small small-btn"
                  onclick="switchEditorTab('sets')"
                >
                  +√öj szett
                </button>
              </div>
              <label
                >A szettek kiz√°r√≥lag a k√∂nnyebb kezel√©s √©rdek√©ben k√©sz√ºltek;
                b√°rmilyen m√≥dos√≠t√°s rajtuk <b>NEM</b> √©rinti a t√∂bbi
                kazamat√°t.</label
              >
              <div id="allSets" class="scrollable-list small"></div>
            </div>

            <div class="mb-30">
              <div class="flex-header">
                <h4 class="subheader">Kazamat√°k</h4>
                <button
                  class="action-btn small small-btn"
                  onclick="switchEditorTab('dungeons')"
                >
                  +√öj Kazamata
                </button>
              </div>
              <div id="allDungeons" class="scrollable-list small"></div>
            </div>

            <div class="mb-30">
              <div class="flex-header">
                <h4 class="subheader">K√©pess√©gek</h4>
                <button
                  class="action-btn small small-btn"
                  onclick="switchEditorTab('abilities')"
                >
                  +√öj K√©pess√©g
                </button>
              </div>
              <div id="allPowers" class="scrollable-list small"></div>
            </div>

            <div class="mb-30">
              <div class="flex-header">
                <h4 class="subheader">Katakomb√°k</h4>
                <button
                  class="action-btn small small-btn"
                  onclick="switchEditorTab('paths')"
                >
                  +√öj Katakomba
                </button>
              </div>
              <div id="allRoutes" class="scrollable-list small"></div>
            </div>

            <div id="contextMenu">
              <button class="context-tab" id="contextEdit" onclick="">
                Szerkeszt√©s
              </button>
              <button
                class="context-tab delete-btn"
                id="contextDelete"
                onclick=""
              >
                T√∂rl√©s
              </button>
            </div>
          </div>

          <div id="editor-cards" class="editor-section">
            <div class="editor-breadcrumb">
              <span>Vil√°gszerkeszt≈ë</span> /
              <span class="current">K√°rtya L√©trehoz√°sa</span>
            </div>

            <h3>üÉè √öj K√°rtya L√©trehoz√°sa</h3>
            <h5>Hozz l√©tre norm√°l k√°rty√°kat vagy boss ellens√©geket</h5>

            <div class="form-group">
              <label>K√°rtya Neve:</label>
              <input
                type="text"
                id="cardName"
                placeholder="Pl.: T≈±zm√°gus, ≈êr√ºlt Lovag..."
              />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>T√°mad√°s:</label>
                <input type="number" id="cardAttack" value="1" min="0" />
              </div>
              <div class="form-group">
                <label>√âleter≈ë:</label>
                <input type="number" id="cardHealth" value="1" min="1" />
              </div>
            </div>

            <div class="form-group">
              <label>Elem:</label>
              <select id="cardElement">
                <option value="tuz">üî• T≈±z</option>
                <option value="viz">üíß V√≠z</option>
                <option value="fold">üåç F√∂ld</option>
                <option value="levego">üí® Leveg≈ë</option>
              </select>
            </div>

            <div class="form-group checkbox-group">
              <input
                type="checkbox"
                id="isBoss"
                class="tech-checkbox"
                onchange="toggleBossInputs()"
              />
              <label for="isBoss">Ez egy F≈ëellens√©g (Boss)</label>
            </div>

            <div id="bossInputs" class="boss-section hidden">
              <h4 class="boss-title">Boss Be√°ll√≠t√°sok</h4>
              <div class="form-group">
                <label>Boss Megjelen√≠t√©si Neve:</label>
                <input
                  type="text"
                  id="bossName"
                  placeholder="Pl.: A V√©rv√∂r√∂s Lovag"
                />
              </div>
              <div class="form-group">
                <label>Boss J√°rtass√°g:</label>
                <select id="bossProficiency">
                  <option value="sebzes">‚öîÔ∏è Sebz√©s</option>
                  <option value="eletero">‚ù§Ô∏è √âleter≈ë</option>
                </select>
              </div>
            </div>

            <div class="button-row mt-30">
              <button class="action-btn" onclick="createCardPlaceholder()">
                ‚úì K√°rtya L√©trehoz√°sa
              </button>
            </div>
          </div>

          <div id="editor-plydeck" class="editor-section">
            <div class="editor-breadcrumb">
              <span>Vil√°gszerkeszt≈ë</span> /
              <span class="current">Kezd≈ëpakli Be√°ll√≠t√°sa</span>
            </div>

            <h3>üé¥ J√°t√©kos Kezd≈ëk√°rty√°i</h3>
            <h5>V√°laszd ki, mely k√°rty√°kkal kezd a j√°t√©kos</h5>

            <div id="plyCardSelect"></div>
          </div>

          <div id="editor-abilities" class="editor-section">
            <div class="editor-breadcrumb">
              <span>Vil√°gszerkeszt≈ë</span> /
              <span class="current">K√©pess√©g L√©trehoz√°sa</span>
            </div>

            <h3>‚ö° √öj K√©pess√©g L√©trehoz√°sa</h3>
            <h5>Hozz l√©tre k√ºl√∂nleges k√©pess√©geket a k√°rty√°khoz</h5>

            <div class="form-group">
              <label>K√©pess√©g Neve:</label>
              <input
                type="text"
                id="abilityName"
                placeholder="Pl.: T≈±zgoly√≥, Gy√≥gy√≠t√≥ Aura..."
              />
            </div>

            <div class="form-group">
              <label>T√≠pus:</label>
              <select id="abilityType" onchange="updateAbilityPreview()">
                <option value="Heal">üíö Gy√≥gy√≠t√°s</option>
                <option value="Shield">üõ°Ô∏è Pajzs</option>
                <option value="InstantDamage">‚öîÔ∏è Azonnali Sebz√©s</option>
                <option value="DamageBuff">üí• Sebz√©s Er≈ës√≠t√©s</option>
              </select>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>√ârt√©k:</label>
                <input
                  type="number"
                  id="abilityValue"
                  value="2"
                  min="1"
                  onchange="updateAbilityPreview()"
                />
                <small>Gy√≥gy√≠t√°s/Sebz√©s mennyis√©ge vagy buff sz√°zal√©k</small>
              </div>
              <div class="form-group">
                <label>Id≈ëtartam (k√∂r√∂k):</label>
                <input
                  type="number"
                  id="abilityDuration"
                  value="0"
                  min="0"
                  onchange="updateAbilityPreview()"
                />
                <small>0 = azonnali hat√°s</small>
              </div>
            </div>

            <div class="form-group">
              <label>Ritkas√°g: <span id="rarityLabel">K√∂z√∂ns√©ges</span></label>
              <input
                type="range"
                id="abilityRarity"
                min="1"
                max="500"
                value="300"
                class="custom-slider"
                oninput="updateRarityLabel()"
              />
              <small>Magasabb √©rt√©k = gyakoribb</small>
            </div>

            <div class="form-group">
              <label>Le√≠r√°s (opcion√°lis):</label>
              <input
                type="text"
                id="abilityDescription"
                placeholder="Automatikus, ha √ºresen hagyod"
              />
            </div>

            <div class="ability-preview">
              <strong>üìã El≈ën√©zet:</strong>
              <p id="abilityPreview">Visszakap 2 √©leter≈ët</p>
            </div>

            <div class="button-row mt-30">
              <button class="action-btn" onclick="createAbility()">
                ‚úì K√©pess√©g L√©trehoz√°sa
              </button>
            </div>
          </div>

          <div id="editor-sets" class="editor-section">
            <div class="editor-breadcrumb">
              <span>Vil√°gszerkeszt≈ë</span> /
              <span class="current">Szett √ñssze√°ll√≠t√°sa</span>
            </div>

            <h3>üì¶ K√°rtya Szett K√©sz√≠t√©se</h3>
            <h5>Csoportos√≠tsd a k√°rty√°kat szettekbe a kazamat√°khoz</h5>

            <div class="form-group">
              <label>Szett Neve:</label>
              <input
                type="text"
                id="setName"
                placeholder="Pl.: T≈±z √âl≈ëhelyek, Erdei L√©nyek..."
              />
            </div>

            <div class="form-group">
              <label>K√°rty√°k Kiv√°laszt√°sa:</label>
              <p class="help-text">
                Kattints a k√°rty√°kra hogy hozz√°add ≈ëket a szetthez
              </p>
              <div id="cardSelectionList" class="scrollable-list small"></div>
            </div>

            <div class="button-row mt-30">
              <button class="action-btn" onclick="createSetPlaceholder()">
                ‚úì Szett Ment√©se
              </button>
            </div>
          </div>

          <div id="editor-dungeons" class="editor-section">
            <div class="editor-breadcrumb">
              <span>Vil√°gszerkeszt≈ë</span> /
              <span class="current">Kazamata Tervez√©se</span>
            </div>

            <h3>üè∞ √öj Kazamata L√©trehoz√°sa</h3>
            <h5>Tervezz meg kih√≠v√°sokat a j√°t√©kosok sz√°m√°ra</h5>

            <div class="form-group">
              <label>Kazamata Neve:</label>
              <input
                type="text"
                id="dungeonName"
                placeholder="Pl.: Az √âg≈ë Erd≈ë, S√∂t√©t Kripta..."
              />
            </div>

            <div class="form-group">
              <label>M√©ret:</label>
              <select id="dungeonType" onchange="toggleDungeonInputs()">
                <option value="egyszeru">üîπ Egyszer≈±</option>
                <option value="kis">üî∏ K√∂zepes</option>
                <option value="nagy">üî∂ Nagy</option>
              </select>
            </div>

            <div class="form-group">
              <label>Ellens√©ges Pakli (Szett):</label>
              <select id="dungeonDeck" onchange="updatePreview()">
                <option value="">V√°lassz egy szettet...</option>
              </select>

              <div id="preview" class="preview mt-15">
                <h4 class="preview-title">üìã Szett El≈ën√©zet:</h4>
                <div id="cardPreview" class="scrollable-list small"></div>
              </div>
            </div>

            <div id="dungeonBossInput" class="boss-input hidden">
              <div class="form-group">
                <label>Vez√©r V√°laszt√°sa:</label>
                <p class="help-text">V√°laszd ki a kazamata v√©gs≈ë ellens√©g√©t</p>
                <div id="bossChooser" class="scrollable-list small"></div>
              </div>
            </div>

            <div class="form-group">
              <label>Jutalom T√≠pusa:</label>
              <select id="rewardType">
                <option value="eletero">‚ù§Ô∏è √âleter≈ë N√∂vel√©s</option>
                <option value="sebzes">‚öîÔ∏è T√°mad√°s N√∂vel√©s</option>
                <option value="kartya">üéÅ √öj K√°rtya</option>
              </select>
            </div>

            <div class="button-row mt-30">
              <button class="action-btn" onclick="createDungeonPlaceholder()">
                ‚úì Kazamata L√©trehoz√°sa
              </button>
            </div>
          </div>

          <div id="editor-paths" class="editor-section">
            <div class="editor-breadcrumb">
              <span>Vil√°gszerkeszt≈ë</span> /
              <span class="current">Katakomb√°k</span>
            </div>

            <h3>üó∫Ô∏è Katakomb√°k</h3>
            <h5>Hamarosan el√©rhet≈ë funkci√≥</h5>

            <div class="coming-soon">
              <div class="construction-icon">üöß</div>
              <p class="coming-title">Ez a funkci√≥ fejleszt√©s alatt √°ll</p>
              <p class="coming-desc">
                A t√©rk√©p √©s katakomba rendszer hamarosan el√©rhet≈ë lesz!
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts at the end of body (best practice) -->
    <script src="scripts/app.js"></script>
  </body>
</html>
